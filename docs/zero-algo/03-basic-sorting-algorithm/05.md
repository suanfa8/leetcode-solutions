# 第 3.5 节 循环不变量

这一节的内容不多，但是非常重要。

![image-20200717163610228](https://tva1.sinaimg.cn/large/007S8ZIlgy1ggu2274cw1j316a0liju1.jpg)

使用循环不变量这个概念可以帮助我们理解和证明算法的有效性。有的算法虽然很直观，但是要证明算法的有效性，需要借助循环不变量这个概念。我们在《二分查找》这一章节的注释里写的诸如：「下一轮搜索区间在 `[left, mid]` 」就是关于二分查找算法的循环不变量的描述。

循环不变量还能够帮助我们写出正确的代码，特别是对于边界条件的讨论。有的时候把循环不变量作为注释写在代码里，可以帮助我们理清代码的逻辑，也有助于他人理解我们的代码。

---

## 什么是循环不变量

循环不变量通常来说是一种语言描述，描述了在循环过程中，我们所设计的变量保持不变的性质。其中：

+ 量：表示了一个或者若干个变量；
+ 循环不变：这若干个变量在循环的过程中，保持了它们各自的性质；

遍历的过程分为 3 个阶段：初始时、循环过程中、结束时。考虑清楚这 3 个阶段的逻辑，能够让我们更清楚变量的边界在哪里。

---

## 选择排序的循环不变量

语言描述：区间 `[0, i)` 有序，即 `i` 之前的元素有序，并且它们中的元素都放在了**最终**应该在的位置。

我们考察选择排序的 3 个阶段：

+ 初始时：`i = 0` 区间 `[0, i)` 为空； 
+ 循环过程中：我们把 `i` 到数组末尾的区间 `[i, len - 1]` 的最小的元素交换到 `i` 的位置，然后 `i` 自增 $1$，这样一来，在下一轮循环开始之前，区间 `[0, i)` 有序的性质仍然成立；
+ 结束时：`i = len`，区间 `[0, len)` 有序，即区间 `[0, len - 1]` 有序，算法的有效性得证。

---

## 插入排序的循环不变量

语言描述：区间 `[0, i)` 有序，这里同样是设计成 `i` 之前的元素有序，只不过不要求这些元素一定放置在排好序后最终应该在的位置。

我们考察选择排序的 3 个阶段：

- 初始时：`i = 0` 区间 `[0, i)` 为空； 
- 循环过程中：我们把 `i` 位置的元素插入到区间 `[0, i)` 中，然后 `i` 自增 $1$，这样一来，在下一轮循环开始之前，区间 `[0, i)` 有序这条性质仍然成立；
- 结束时：`i = len`，区间 `[0, len)` 有序，即区间 `[0, len - 1]` 有序，算法的有效性得证。

---

## 练习


1. 使用循环不变量完成「力扣」第 283 题：[移动零](https://leetcode-cn.com/problems/move-zeroes/)。

---

这就是这一章的内容，下一章我们主要学习两个非常经典的排序算法：「归并排序」和「快速排序」，这两个排序算法是非常重要的。我们下一章节再见。



