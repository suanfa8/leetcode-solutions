# 第 3.4 节 排序算法的评价指标

我们已经学习了两个排序算法，也比较过它们之间的优劣，这一节我们介绍排序算法的评价指标。

![image-20200717162910714](https://tva1.sinaimg.cn/large/007S8ZIlgy1ggu1uxf8a7j31g40n278f.jpg)

排序算法的评价指标主要有以下 4 个：

+ 时间复杂度：分得细一点，可以是「最差时间复杂度」、「平均时间复杂度」、「最好时间复杂度」；
+ 额外空间复杂度；
+ 是否是原地排序；
+ 稳定性。
---

## 时间复杂度

从「插入排序」的学习中我们知道：算法的执行时间是与测试用例相关的。在这里，我们帮助大家复习一些相关的结论。

+ 选择排序的执行时间与测试用例无关，即使是已经排好序的数组，选择排序都不会提前检测到数组已经排序而提前终止；
+ 插入排序的内层循环有一定概率会提前终止，插入排序在「已经有序的数组」以及「接近有序的数组」上执行时间较快，这是因为在这两类数组上的比较和交换（赋值）的次数相对较少；
+ 插入排序在完全逆序的数组上的执行时间最慢；
+ 冒泡排序会提前检测到数组是否有序，一旦检测到数组有序，算法终止。

---

## 额外空间复杂度

对于排序算法来说，空间复杂度一般指在执行排序的过程中需要使用的额外空间。我们学习过的选择排序、冒泡排序、插入排序、希尔排序在排序的过程中都不需要使用额外的空间。

---

## 原地排序

原地排序就是指在排序过程中不申请多余的存储空间，只利用原来存储待排数据的存储空间进行比较和交换的数据排序，额外申请的常数个用于交换的变量不计算在内。由这个概念，我们不难知道，选择排序、冒泡排序、插入排序、希尔排序都是原地排序。

原地排序并不意味着额外空间复杂度为 $O(1)$ ，我们在下一章学习到「快速排序」的时候，就能够说清楚这两个概念的细微差别。

---

## 稳定性

稳定性是指相等的元素在排序之后的相对位置没有改变。即对于相同的元素，原来靠前的元素在排序以后还靠前，原来靠后的元素在排序以后还靠后。

「稳定性」常常是针对「待排序数组」有很多值相同的元素和对象数组而言的。例如：我们的数据是按照生成的时间排序的，在对排序关键字段排序以后，我们通常希望在排序以后，原来靠前的数据依然靠前。此时稳定的排序算法则是我们所需要的。

「选择排序」不是一个稳定的排序算法。这是因为相同数值的元素，在交换的过程中，并不能保证它们的顺序和初始的顺序一致。

「冒泡排序」遇到元素相等的时候，不需要也没有必要交换位置，因此是稳定排序。

「插入排序」是稳定的。我们考虑内层循环停止的条件：`nums[j - 1] > temp`，严格小于才交换，则说明：看到一个数大于等于当前要插入的那个数，就停止。所以对于相同的元素而言，原来靠后位置的元素在这种规则下，不会跑到与它相等的元素之前。因此，「插入排序」是一个稳定排序。由此我们可以看出，说「稳定性」是指这个算法描述天然具有稳定性的特点，我们在实现的时候需要对一些细节的地方留心，否则很可能把一个稳定的排序算法实现成了不稳定的排序算法。

「希尔排序」由于有间隔和跳跃的特点，它不是稳定排序。

### 稳定化

我们都在 Excel 里排过序，其实我们只需要给输入数据新增一个从 $1$ 开始的序列 $[1,2,\dots]$ ，在对关键字进行排序的时候把这个关键字作为第 2 排序关键字，就可以解决稳定性的问题，这一点叫「稳定化」。

在介绍完了排序算法的评价指标以后，我们可以填写以下表格，以比较不同排序算法的特点。

---

## 总结

|          | 最坏时间复杂度 | 平均时间复杂度                    | 最好时间复杂度| 额外空间复杂度 | 稳定性 | 是否原地排序 |
| -------- | -------------- | ---------------------------------- | -------------- | -------------- | ------ | ------------ |
| 选择排序 | $O(N^2)$       | $O(N^2)$                           | $O(N^2)$       | $O(1)$         | 不稳定 | 原地排序     |
| 冒泡排序 | $O(N^2)$       | $O(N^2)$                           | $O(N)$         | $O(1)$         | 稳定   | 原地排序     |
| 插入排序 | $O(N^2)$       | $O(N^2)$                           | $O(N)$         | $O(1)$         | 稳定   | 原地排序     |
| 希尔排序 | $O(N^2)$       | $O(n^{1.25}) \sim O(1.6 n^{1.25})$ | (没有相关研究) | $O(1)$         | 不稳定 | 原地排序     |

---

这一节我们介绍了评价排序算法的 4 个指标，下一节我们介绍「循环不变量」这个概念，感谢大家。




