# 第 4.6 节 主定理简介

「主定理」是一个分析复杂度的工具，主要用于求解「递归」方法的时间复杂度。由于「主定理」的理论性很强，但我们只需要知道主定理的结论就好，我们在描述「主定理」的部分，不会太注重一些细节和例外的部分，请大家留意。严谨的论述请参考《算法导论》第 4.5 节和第 4.6 节的内容。

在面试的时候，几乎不会考察主定理的内容和证明。

## 递归与分治

+ 递归是编程技巧，是 **直接体现在代码上** 的，即 **函数自己调用自己**，每一层递归调用，传入的参数的值是不一样的；
+ 分治是一种算法设计的思想，绝大部分情况下是通过递归实现的。即：子问题的求解通过递归方法实现。

## 主定理

如果一个规模为 $n$ 的问题，可以拆解为 $a$ 个子问题，每个子问题的规模是 $\cfrac{n}{b}$，其中 $a \ge 1$，$b > 1$。用 $f(n)$ 表示分解和合并的开销与 $n$ 的关系，那么原始问题的时间复杂度 $T(n)$ 可以表示成如下递归式：

$$
T(n) = a \cdot T (\cfrac{n}{b}) + f(n)
$$

将此递推式得到关于 $n$ 的通项公式的时候，需要利用以下结论：

+ 如果 $f(n) < n^{\log_{b}a}$，那么 $T(n) = O(\log n)$；
+ 如果 $f(n) = n^{\log_{b}a}$，那么 $T(n) = O(n^{\log_{b}a} \cdot \log n)$；
+ 如果 $f(n) > n^{\log_{b}a}$，那么 $T(n) = O(f(n))$。

证明过程请参考《算法导论》第 4.6 节（证明主定理）。结论可以这样记忆，比较 $f(n)$ 与 $n^{\log_{b}a}$ 的大小，如果相等，$T(n)$ 等于 $n^{\log_{b}a}$ 后面乘以 $\log n$。如果不相等，谁大就以谁作为时间复杂度，这一点与「时间复杂度考虑最差情况」是一致的。

### 根据主定理推导「二分查找」算法的时间复杂度

二分查找每一次将问题一分为二，但是只在其中一个子问题里继续求解，此时 $a = 1$，$b = 2$。只有拆分子问题，不用合并子问题，此时 $f(n) = 1$（常数次操作，与 $n$ 无关）。比较 $n^{\log_{b}a} = n^{\log_{2}1} = n^{0} = 1$，套用主定理的第二种情况，此时 $T(n) = O(\log n)$。

### 根据主定理推导「归并排序」算法的时间复杂度

二分查找每一次将问题一分为二，然后递归在两个子问题里继续求解，此时 $a = 2$，$b = 2$。拆分子问题使用了 $O(1)$，合并子问题使用了 $f(n) = n$，此时 $f(n) = n$。比较 $n^{\log_{b}a} = n^{\log_{2}2} = n$，套用主定理的第二种情况，此时 $T(n) = O(n \log n)$。




